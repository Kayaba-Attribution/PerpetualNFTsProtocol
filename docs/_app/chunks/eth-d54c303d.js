import{R as n,D as y,W as D,T as I}from"./vendor-e23481e1.js";var O=[{inputs:[{internalType:"address",name:"_nftToken",type:"address"},{internalType:"address payable",name:"_treasury",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Borrow",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Deposit",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"address",name:"liquidator",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenid",type:"uint256"}],name:"Liquidate",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Release",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Repay",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Withdraw",type:"event"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bool",name:"wMATIC",type:"bool"}],name:"borrow",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"borrowed",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"borrowedTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"collateralAmount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"}],name:"collateralNFT",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"collateralNFTOwner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"currentDebt",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"}],name:"deposit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"depositedNFTs",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"healthFactor",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"liquidate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"maxBorrow",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"nftToken",outputs:[{internalType:"contract MyToken",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"from",type:"address"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC721Received",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"pure",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"}],name:"release",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"repay",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"totalDebt",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"totalNFTS",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"treasury",outputs:[{internalType:"contract Treasury",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"}],name:"withdraw",outputs:[],stateMutability:"nonpayable",type:"function"}],B=[{inputs:[{internalType:"address",name:"_treasury",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"approved",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"approve",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"mint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"nftValue",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"pure",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"bytes",name:"_data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenOfOwnerByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"transferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"treasury",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"}];async function C(p,a,e){const r=await n(b);p===r&&a===f.museum&&k.set(e)}async function E(p,a,e){const r=await n(b);if(a===r){const t=await n(m);t.push(e),m.set([...t]);const u=await n(d);d.set(Number(u)+1)}else if(p===r){const t=await n(m);m.set([...t.filter(s=>Number(s)!==Number(e))]);const u=await n(d);d.set(Number(u)-1)}if(p==r&&a==f.museum){const t=await n(c);t.push(Number(e)),c.set([...t]);const u=await n(o);o.set(Number(u)+1)}if(p==f.museum&&a==r){const t=await n(c);c.set([...t.filter(s=>s!==Number(e))]);const u=await n(o);o.set(Number(u)-1)}if(p=="0x0000000000000000000000000000000000000000"){const t=await n(l);l.set(Number(t)+1)}else if(a=="0x0000000000000000000000000000000000000000"){const t=await n(l);l.set(Number(t)-1)}const w=await n(_);A.set(await w.provider.getBalance(r))}async function S(p,a){const e=n(b),r=await n(o);p===e&&o.set(Number(r)-1)}let g=!1;function R(){g||(g=!0,i.perpetual.off("ApprovalForAll"),i.perpetual.on("ApprovalForAll",C),i.perpetual.off("Transfer"),i.perpetual.on("Transfer",E),i.museum.off("Release"),i.museum.on("Release",S))}const M=80001,H="0x"+M.toString(16);let T;const i={},b=y(""),d=y(0),o=y(0),x=y(!0),k=y(!1),_=y(),A=y(0),l=y(0),m=y([]),c=y([]),q={80001:{museum:"0xC90cb99EE0877c42a0B7FA9e437bffd4239969b1",treasury:"0x0775655ab9E77DCDb3a4d08631Db192f626a19Fd",perpetual:"0x1830e4E3F11910FcA52e9E1d891B61C87998D84c"},31337:{museum:"0xf219d840AA063d406Ecbcb5A6f0173CD8Dc9553f",treasury:"0x88876ccD4DC83c990aC59B3106E313562c8bc747",perpetual:"0x6f53118cdAC5726b1B4671c3F4fae024163eD042"}},f=q[M];let h=()=>{};const P=y(new Promise(p=>{h=p}));function F(){b.set(""),d.set(0),o.set(0),x.set(!0),k.set(!1),_.set(),A.set(0),l.set(0),m.set([]),c.set([]),P.set(new Promise(p=>{h=p}))}function L(){window.ethereum.enable(),N()}async function N(){if(T||(T=new D(window.ethereum,"any"),T.on("network",(s,v)=>{v&&setTimeout(()=>{F(),N()},0)}),window.ethereum.on("accountsChanged",()=>{setTimeout(()=>{F(),N()},0)})),(await T.getNetwork()).chainId!==M){x.set(!0);return}else x.set(!1);let a,e;try{a=await T.getSigner(),e=await a.getAddress(),b.set(e)}catch(s){console.error(s);return}_.set(a),i.museum=new I(f.museum,O,a),i.perpetual=new I(f.perpetual,B,a);const r=await i.perpetual.isApprovedForAll(e,f.museum);k.set(r),A.set(await a.provider.getBalance(e));const w=await i.perpetual.balanceOf(e);d.set(w),l.set(await i.perpetual.totalSupply()),o.set(await i.museum.totalNFTS(e));const t=[];for(let s=0;s<w;s++)t.push(i.perpetual.tokenOfOwnerByIndex(e,String(s)));i.museum.depositedNFTs(e).then(s=>{c.set(s.map(v=>v.toNumber()))});let u=await Promise.all(t);u=u.map(s=>s.toNumber()),m.set(u),R(),h()}async function j(){await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:H}]})}export{b as a,d as b,i as c,P as d,k as e,c as f,N as i,L as l,o as m,m as n,j as p,l as t,x as w};
