import{R as n,D as y,W as O,T as F}from"./vendor-e23481e1.js";var B=[{inputs:[{internalType:"address",name:"_nftToken",type:"address"},{internalType:"address payable",name:"_treasury",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Borrow",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Deposit",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"address",name:"liquidator",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenid",type:"uint256"}],name:"Liquidate",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Release",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Repay",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"owner",type:"address"},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Withdraw",type:"event"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bool",name:"wMATIC",type:"bool"}],name:"borrow",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"borrowed",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"borrowedTime",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"collateralAmount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"}],name:"collateralNFT",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"collateralNFTOwner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"currentDebt",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"}],name:"deposit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"depositedNFTs",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"healthFactor",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"liquidate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"maxBorrow",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"nftToken",outputs:[{internalType:"contract MyToken",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"from",type:"address"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC721Received",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"pure",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"}],name:"release",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"repay",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"totalDebt",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"totalNFTS",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"treasury",outputs:[{internalType:"contract Treasury",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_id",type:"uint256"}],name:"withdraw",outputs:[],stateMutability:"nonpayable",type:"function"}],D=[{inputs:[{internalType:"address",name:"_treasury",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"approved",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!0,internalType:"uint256",name:"tokenId",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"approve",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"getApproved",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"mint",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"nftValue",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"pure",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ownerOf",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"},{internalType:"bytes",name:"_data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"uint256",name:"index",type:"uint256"}],name:"tokenOfOwnerByIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"tokenURI",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"transferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"treasury",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"}];async function E(p,a,e){const r=await n(w);p===r&&a===c.museum&&k.set(e)}async function C(p,a,e){const r=await n(w);if(a===r){const t=await n(m);t.push(e),m.set([...t]);const u=await n(d);d.set(Number(u)+1)}else if(p===r){const t=await n(m);m.set([...t.filter(s=>Number(s)!==Number(e))]);const u=await n(d);d.set(Number(u)-1)}if(p==r&&a==c.museum){const t=await n(f);t.push(Number(e)),f.set([...t]);const u=await n(o);o.set(Number(u)+1)}if(p==c.museum&&a==r){const t=await n(f);f.set([...t.filter(s=>s!==Number(e))]);const u=await n(o);o.set(Number(u)-1)}if(p=="0x0000000000000000000000000000000000000000"){const t=await n(l);l.set(Number(t)+1)}else if(a=="0x0000000000000000000000000000000000000000"){const t=await n(l);l.set(Number(t)-1)}const b=await n(_);A.set(await b.provider.getBalance(r))}async function S(p,a){const e=n(w),r=await n(o);p===e&&o.set(Number(r)-1)}let I=!1;function R(){I||(I=!0,i.perpetual.off("ApprovalForAll"),i.perpetual.on("ApprovalForAll",E),i.perpetual.off("Transfer"),i.perpetual.on("Transfer",C),i.museum.off("Release"),i.museum.on("Release",S))}const M=80001,H="0x"+M.toString(16);let T;const i={},w=y(""),d=y(0),o=y(0),x=y(!0),k=y(!1),_=y(),A=y(0),l=y(0),m=y([]),f=y([]),q={80001:{museum:"0x8104AECa7bE988437d033aF58a171A53119648Ce",treasury:"0x11f7E9E4053BDDF9062fE4A227d91521551490bD",perpetual:"0x5f67b1eCC8C855bFbF6Ea051853D67e266f5e278"},31337:{museum:"0xA7116B7C935B6F55BE6AA34cb84A69C6feE93f45",treasury:"0xB0BEe9086720EfB9101cfa0FB07d91ae530F2D70",perpetual:"0x5ee4f74FD464df7615cCe7a4895A4eC942a8972F"}},c=q[M];let h=()=>{};const P=y(new Promise(p=>{h=p}));function g(){w.set(""),d.set(0),o.set(0),x.set(!0),k.set(!1),_.set(),A.set(0),l.set(0),m.set([]),f.set([]),P.set(new Promise(p=>{h=p}))}function L(){window.ethereum.enable(),N()}async function N(){if(T||(T=new O(window.ethereum,"any"),T.on("network",(s,v)=>{v&&setTimeout(()=>{g(),N()},0)}),window.ethereum.on("accountsChanged",()=>{setTimeout(()=>{g(),N()},0)})),(await T.getNetwork()).chainId!==M){x.set(!0);return}else x.set(!1);let a,e;try{a=await T.getSigner(),e=await a.getAddress(),w.set(e)}catch(s){console.error(s);return}_.set(a),i.museum=new F(c.museum,B,a),i.perpetual=new F(c.perpetual,D,a);const r=await i.perpetual.isApprovedForAll(e,c.museum);k.set(r),A.set(await a.provider.getBalance(e));const b=await i.perpetual.balanceOf(e);d.set(b),l.set(await i.perpetual.totalSupply()),o.set(await i.museum.totalNFTS(e));const t=[];for(let s=0;s<b;s++)t.push(i.perpetual.tokenOfOwnerByIndex(e,String(s)));i.museum.depositedNFTs(e).then(s=>{f.set(s.map(v=>v.toNumber()))});let u=await Promise.all(t);u=u.map(s=>s.toNumber()),m.set(u),R(),h()}async function j(){await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:H}]})}export{w as a,d as b,i as c,P as d,k as e,f,N as i,L as l,o as m,m as n,j as p,l as t,x as w};
